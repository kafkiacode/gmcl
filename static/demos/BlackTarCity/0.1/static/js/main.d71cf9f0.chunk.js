(window["webpackJsonpblack-tar"]=window["webpackJsonpblack-tar"]||[]).push([[0],{57:function(e,t,r){e.exports=r(76)},75:function(e,t,r){},76:function(e,t,r){"use strict";r.r(t);var a,n=r(0),c=r.n(n),o=r(45),i=r.n(o),u=r(8),s=r(1),l=r(19),m=r(78),f=new s.BoxBufferGeometry,h=new s.SphereBufferGeometry,d=Object(n.createContext)({}),p=function(e){var t=e.height,r=void 0===t?1:t,a=e.width,o=void 0===a?50:a,i=e.position,u=void 0===i?[0,r/2,0]:i,h=e.color,d=void 0===h?"lime":h,p=e.useTexture,g=void 0!==p&&p,b=Object(n.useMemo)(function(){return g&&(new s.TextureLoader).load("./textures/TexturesCom_HighRiseNight0060_M_3.jpg")},[g]);console.log(b);var O=Object(l.c)({from:{offset:[0,0]},to:{offset:[-5,10]},config:{mass:100,friction:1e3}}).offset;return c.a.createElement("mesh",{position:u,scale:[o,r,o],geometry:f},c.a.createElement("meshBasicMaterial",{attach:"material",color:d},g&&c.a.createElement(m.a.primitive,{attach:"map",object:b,wrapS:s.RepeatWrapping,wrapT:s.RepeatWrapping,repeat:[2.5,5],offset:O})))},g=function(){var e=Object(n.useContext)(d),t=e.palette,r=e.useTexture;return c.a.createElement("group",null,c.a.createElement(p,{useTexture:r,position:[500,150,500],height:300,color:t[0]}),c.a.createElement(p,{useTexture:r,position:[500,125,-500],height:250,color:t[1]}),c.a.createElement(p,{useTexture:r,position:[-500,175,500],height:350,color:t[2]}),c.a.createElement(p,{useTexture:r,position:[-500,75,-500],height:150,color:"lime"}))},b=r(13),O=r(21),j=r(7),v=r(15),E=r(46),y=r(80);function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(r,!0).forEach(function(t){Object(v.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var P={};function R(e){var t=e.attr,r=e.addObject,c=void 0===r?{}:r,o=e.colorObject,i=void 0===o?{}:o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Controls";a||(a=new E.a(t));var s=Object(n.useState)(function(){return M({},Object(y.a)(function(e){return Array.isArray(e)?e[0]:e},c),{},i)}),l=Object(b.a)(s,2),m=l[0],f=l[1];return Object(n.useEffect)(function(){P[u]||(P[u]=a.addFolder(u));var e=P[u];Object.keys(c).filter(function(e){return["number","string","boolean"].includes(typeof c[e])}).forEach(function(t){e.add.apply(e,[m,t].concat(Object(j.a)(Array.isArray(c[t])?c[t].slice(1):[]))).onChange(function(e){return f(function(r){return M({},r,Object(v.a)({},t,e))})})}),Object.keys(i).forEach(function(e){a.addColor(m,e).onChange(function(t){return f(function(r){return M({},r,Object(v.a)({},e,t))})})})},[]),M({gui:a},m)}var w=function(e){var t=e.initialOn,r=void 0!==t&&t,a=e.position,o=void 0===a?[0,2e3,0]:a,i=e.target,s=void 0===i?[0,0,0]:i,l=Object(n.useRef)(r).current,m=Object(u.g)(),f=m.setDefaultCamera,h=m.camera,d=m.size,p=d.width,g=d.height,O=Object(n.useState)(!1),j=Object(b.a)(O,2),v=j[0],E=j[1],y=R({addObject:{isOn:l}}).isOn,C=Object(n.useRef)(h),M=Object(n.useRef)();return Object(n.useEffect)(function(){h!==M.current&&(v||(C.current=h))},[h,v]),Object(n.useEffect)(function(){return y&&!v&&(f(M.current),E(!0)),!y&&v&&(f(C.current),E(!1)),function(){v&&f(C.current)}},[y,v]),Object(n.useEffect)(function(){M.current.rotation.set(Math.PI/2,Math.PI,0)},[s]),c.a.createElement("perspectiveCamera",{name:"debugCamera",ref:M,aspect:p/g,position:o,onUpdate:function(e){return e.updateProjectionMatrix()},near:1,far:10100})},x=r(79),S=r(33),k=r.n(S),I=r(49),T=Object(n.createContext)(),B=Object(n.memo)(function(e){var t=e.children,r=Object(n.useContext)(d).loop,a=r.duration,o=r.start,i=Object(l.c)({to:function(){var e=Object(I.a)(k.a.mark(function e(t){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t({angle:2*Math.PI});case 4:return e.next=7,t({angle:2*Math.PI,reset:!0});case 7:e.next=4;break;case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),from:{angle:0},config:{duration:a}});return c.a.createElement(T.Provider,{value:i.angle},t)}),L=r(50),A=Object(n.memo)(function(){var e=Object(n.useState)(),t=Object(b.a)(e,2),r=t[0],a=t[1];return Object(n.useEffect)(function(){(new L.a).load("./models/blade_runner_car/scene.gltf",function(e){e.scene.children[0].scale.set(.5,.5,.5),a(e.scene.children[0])},console.log,console.error)},[]),r?c.a.createElement("primitive",{object:r,position:[0,0,0],rotation:[Math.PI/-2-.2,0,0]}):null}),V=Object(n.memo)(function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("mesh",{geometry:f,scale:[1,1,1]},c.a.createElement("meshBasicMaterial",{color:"purple",attach:"material"})),c.a.createElement("mesh",{geometry:h,scale:[.5,.5,.5],position:[0,0,.5]},c.a.createElement("meshBasicMaterial",{color:"lightblue",attach:"material"})))}),D={SimpleCar:V,BladeRunnerCar:A},U=Object(n.memo)(function(e){var t=e.children,r=Object(n.useContext)(d),a=r.cityRadius,o=r.car,i=Object(n.useContext)(T),u=D[o]||V;return c.a.createElement(x.a.group,{position:i.interpolate(function(e){return[a*Math.cos(e),0,a*-Math.sin(e)]}),rotation:i.interpolate(function(e){return[0,e+Math.PI,0]})},c.a.createElement(u,null),t)});function z(){var e=Object(u.g)(),t=e.size,r=t.width,a=t.height,o=e.setDefaultCamera,i=e.camera,s=Object(n.useRef)(),l=Object(n.useRef)(i);return Object(n.useEffect)(function(){return l.current=i,o(s.current),function(){o(l.current)}},[]),c.a.createElement("group",{rotation:[0,Math.PI,0],position:[0,1.6,-4]},c.a.createElement("perspectiveCamera",{near:.001,name:"DriverCamera",ref:s,aspect:r/a,onUpdate:function(e){return e.updateProjectionMatrix()}}))}var F=Object(n.memo)(function(e){var t=e.position,r=e.color,a=e.curveArgs;return c.a.createElement("line",{position:t},c.a.createElement("geometry",{attach:"geometry",onUpdate:function(e){e.parent.geometry=e}},c.a.createElement("ellipseCurve",{args:a,onUpdate:function(e){e.parent.vertices=e.getPoints(50).map(function(e){return new s.Vector3(e.x,0,e.y)})}})),c.a.createElement("lineBasicMaterial",{attach:"material",color:r}))}),G=5,H=["red","blue","lightblue"];var N=Object(n.memo)(function(){var e=Object(n.useContext)(d),t=e.cityRadius,r=void 0===t?500:t,a=e.track.simpleLinesCount,o=void 0===a?10:a;return c.a.createElement("group",null,c.a.createElement("mesh",{rotation:[Math.PI/2,0,0],position:[0,.2,0]},c.a.createElement("ringBufferGeometry",{args:[r-.2,r+.2,180,1],attach:"geometry"}),c.a.createElement("meshBasicMaterial",{color:16777215,attach:"material",side:s.DoubleSide,wireframe:!0})),Array(o).fill().map(function(e){var t=e.cityRadius;return function(e,r){var a=t+Math.random()*G-G/2,n=Math.random()*Math.PI*2,c=n+Math.PI/32+Math.random()*(Math.PI/64);return{position:[0,.2+1.5*Math.random(),0],color:H[r%H.length],curveArgs:[0,0,a,a,n,c]}}}({cityRadius:r})).map(function(e){return c.a.createElement(F,e)}))});var _,J=Object(n.memo)(function(){var e=Object(n.useContext)(d),t=e.cityRadius,r=e.lights.directionalLightsCount;return c.a.createElement("group",null,Array(r).fill().map(function(e){var t=e.cityRadius;return function(e,r,a){var n=a.length,c=2*Math.PI/n*r;return{intensity:.2,position:(new s.Vector3).setFromCylindricalCoords(t+100,c,20),color:["blue","red"][r%n]}}}({cityRadius:t})).map(function(e,t){return c.a.createElement("directionalLight",Object.assign({},e,{key:t}))}),c.a.createElement("pointLight",{distance:0,decay:1}))}),W=r(54),q=r(51),K=r(55),Q=r(52),X=r.n(Q);function Y(){return _||(_=new X.a,document.body.appendChild(_.dom)),_}Object(u.c)({EffectComposer:W.a,RenderPass:q.a,UnrealBloomPass:K.a});var Z=function(){var e=Object(n.useRef)(),t=Object(u.g)(),r=t.gl,a=t.scene,o=t.camera,i=t.size,l=i.width,m=i.height;Object(n.useEffect)(function(){r.toneMapping=s.ReinhardToneMapping,r.setClearColor("#000",1),r.setPixelRatio(window.devicePixelRatio)},[r]),Object(n.useEffect)(function(){e.current.setSize(l,m)},[l,m]);var f=Y();Object(u.f)(function(){f.begin(),e.current.render(),f.end()},!0);var h=Object(n.useState)(),d=Object(b.a)(h,2),p=d[0],g=d[1];return Object(n.useEffect)(function(){requestAnimationFrame(function(){g(!1),requestAnimationFrame(function(){return g(!0)})})},[o]),c.a.createElement("effectComposer",{ref:e,args:[r]},p&&c.a.createElement("unrealBloomPass",{attachArray:"passes",args:[new s.Vector2(l,m)],resolution:[l,m],exposure:1,strengh:1.8,threshold:0,radius:.1,renderToScreen:!0}),c.a.createElement("renderPass",{attachArray:"passes",args:[a,o]}))},$=r(34),ee=r(18);function te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){var r=0,a=0;return Array(e).fill().map(function(){var e=1+Math.random()*t-t/2;return r+=e,e}).map(function(e){return a+=e/r})}}var re=function(e){return"number"===typeof e?"#".concat(e.toString(16).padStart(6,"0")):e},ae={color:"blue"};var ne=Object(n.memo)(function(e){var t=e.height,r=void 0===t?10:t,a=e.base,o=void 0===a?2:a,i=e.steps,u=void 0===i?3:i,s=e.heightVariation,l=void 0===s?0:s,m=e.xzVariation,h=void 0===m?0:m,d=e.hslVariation,p=void 0===d?0:d,g=e.color,j=Object(O.a)(e,["height","base","steps","heightVariation","xzVariation","hslVariation","color"]),v=Object(n.useState)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){for(var r=0,a=[],n=0;n<e;n++)a[n]=1+Math.random()*t-t/2,r+=a[n];return a.map(function(e){return e/r})}}(u,l)),E=Object(b.a)(v,1)[0],y=Object(n.useState)(te(u,h)),C=Object(b.a)(y,1)[0],M=Object(n.useState)(te(u,h)),P=Object(b.a)(M,1)[0],R=Object(n.useState)(te(u,h)),w=Object(b.a)(R,1)[0],x=Object(n.useState)(te(u,h)),S=Object(b.a)(x,1)[0];return c.a.createElement("group",Object.assign({name:"MesoHighRise"},j),Array(u).fill().map(function(e,t){var a=(1-(C[t-1]||0))*o,n=(1-(P[t-1]||0))*o,i=(1/u*t-(w[t-1]||0))*o,s=(1/u*t-(S[t-1]||0))*o,l=E[t]*r*(t+1),m=Object($.offsetHSL)(Object($.parse)(re(g)),Object(ee.value)()*Object(ee.sign)()*p*.5*360,Object(ee.value)()*Object(ee.sign)()*p*100,Object(ee.value)()*Object(ee.sign)()*p*100).hex;return c.a.createElement("mesh",{key:t,position:[i,l/2,s],geometry:f,scale:[a,l,n]},c.a.createElement("meshLambertMaterial",Object.assign({attach:"material"},ae,{color:m})))}))}),ce=r(53);function oe(e){var t=e.arcStart,r=e.arcLn,a=e.radius,o=e.height,i=Object(n.useRef)();return c.a.createElement("mesh",{position:[0,o,0],rotation:[Math.PI,0,0]},c.a.createElement("meshLine",{onUpdate:function(e){e.parent.geometry=e.geometry}},c.a.createElement("geometry",{onUpdate:function(e){return e.parent.setGeometry(e)}},c.a.createElement("ellipseCurve",{args:[0,0,a,a,t,t+r],onUpdate:function(e){e.parent.vertices=e.getPoints(50).map(function(e){return new s.Vector3(e.x,0,e.y)})}}))),c.a.createElement("meshLineMaterial",{attach:"material",ref:i,lineWidth:.05,color:16777215}))}function ie(e){var t=e.cityRadius,r=e.radius,a=e.arcStart,o=e.arcLn,i=e.lightTracksCount,u=Object(O.a)(e,["cityRadius","radius","arcStart","arcLn","lightTracksCount"]),l=Object(n.useCallback)(function(e,n,c){var i=c.length,u=Math.PI/i*n+Math.PI/i*.5;return{arcStart:a,arcLn:o,height:.8*r*Math.sin(u),radius:t-.9*r*Math.cos(u)}},[o,a,t,r]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("group",null,Array(i).fill().map(l).map(function(e){return c.a.createElement(oe,e)}),c.a.createElement("group",{rotation:[Math.PI/-2,0,0]},c.a.createElement("mesh",Object.assign({},u,{rotation:[0,0,a]}),c.a.createElement("torusBufferGeometry",{attach:"geometry",args:[t,r,8,6,o]}),c.a.createElement("meshBasicMaterial",{color:0,attach:"material",side:s.DoubleSide})))))}function ue(){var e=Object(n.useContext)(d),t=e.cityRadius,r=e.tunnels,a=r.radius,o=r.count,i=r.lightTracksCount;return c.a.createElement(c.a.Fragment,null,Array(o).fill().map(function(e){var t=e.cityRadius,r=e.radius,a=e.lightTracksCount;return function(e,n,c){var o=c.length;return{radius:r,cityRadius:t,arcStart:n*(2*Math.PI/o),arcLn:Math.PI/16+Math.random()*(Math.PI/16),lightTracksCount:a}}}({cityRadius:t,radius:a,lightTracksCount:i})).map(function(e){return c.a.createElement(ie,e)}))}function se(e){var t=e.settings,r=e.children;window.THREE=s;var a=Y(),o=t.isBloomOn,i=t.bgColor;return Object(u.f)(function(e){var t=e.gl,r=e.scene,n=e.camera;o||(a.begin(),t.render(r,n),a.end())},!o),Object(n.useEffect)(function(){document.body.style.backgroundColor=re(i)},[i]),c.a.createElement(d.Provider,{value:t},r)}Object(u.c)(ce);var le=function(e){var t=e.settings,r=t.mesoHighRisesCount,a=void 0===r?1:r,n=t.isBloomOn,o=t.tunnels,i=t.cityRadius,u=t.palette;return console.log(JSON.parse(JSON.stringify(t))),c.a.createElement(se,{settings:t},c.a.createElement(B,null,c.a.createElement(w,null),c.a.createElement(g,null),c.a.createElement(U,null,c.a.createElement(z,null)),Array(a).fill().map(function(e){var t=e.cityRadius,r=e.tunnelRadius,a=e.palette;return function(e,n,c){var o=c.length,i=2*Math.PI/o*n,u=50*Math.random()-25;return u+=(u>0?1:-1)*(r+2),{hslVariation:.1,heightVariation:1,xzVariation:2,steps:10,height:5+10*Math.random(),base:2,key:n,color:a[n%a.length],position:[(t+u)*Math.cos(i),0,(t+u)*-Math.sin(i)]}}}({cityRadius:i,palette:u,tunnelRadius:o.radius})).map(function(e){return c.a.createElement(ne,e)}),c.a.createElement(N,null),c.a.createElement("mesh",{name:"groundPlane",rotation:[Math.PI/2,0,0]},c.a.createElement("planeGeometry",{args:[1e4,1e4],attach:"geometry"}),c.a.createElement("meshBasicMaterial",{color:8,attach:"material",side:s.DoubleSide})),c.a.createElement(J,null),n&&c.a.createElement(Z,null),c.a.createElement("ambientLight",{color:"#59314f",intensity:.4}),c.a.createElement(ue,null)))},me=r(81),fe=r(82),he=r(44),de=r.t(he,2),pe=[[131860,5845734,8794854,11743974,14693094],[4022623,6411972,7442828,2438203,2171945],[9762560,16766207,14549158,4653127,0],[63999,14221567,1376e3,16711919,0]],ge=(pe.map(function(e){return e.filter(function(e){return 0!==e})}),Object(fe.a)(pe).filter(function(e){return 0!==e})),be={palette:[Object(ee.pick)(de)],bgColor:16777215,cityRadius:10,lights:{directionalLightsCount:4},loop:{duration:25e4,start:!0},isBloomOn:!1,mesoHighRisesCount:40,track:{simpleLinesCount:10},tunnels:{count:0,radius:2.5,lightTracksCount:0},car:"SimpleCar",useTexture:!1},Oe=Object(me.a)(be),je=(Oe({}),Oe({bgColor:0,cityRadius:500,palette:[ge],mesoHighRisesCount:400,track:{simpleLinesCount:250},loop:{duration:6e4,start:!0},tunnels:{count:4,lightTracksCount:5},car:"BladeRunnerCar",useTexture:!0})),ve=(r(75),function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).settingsKey,t=void 0===e?"settings":e;return function(e){function r(r){var a=r.settings,n=Object(O.a)(r,["settings"]),o=R({addObject:a},e.name||e.displayName),i=M({},n,Object(v.a)({},t,o));return c.a.createElement(e,i)}return r.displayName="withGui(".concat(e.name||e.displayName,")"),r}}()(le));i.a.render(c.a.createElement(u.a,{camera:{name:"CanvasCamera"},onCreated:function(e){var t=e.scene;window.scene=t}},c.a.createElement(ve,{settings:je})),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.d71cf9f0.chunk.js.map